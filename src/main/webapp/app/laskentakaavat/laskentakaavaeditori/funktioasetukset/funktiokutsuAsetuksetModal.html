<!-- Arvojen syöttö -templatet -->
<script type="text/ng-template" id="desimaaliluku-template">
    <input ng-disabled="alikaavaValues.isAlikaava" type="text" size="15" ng-model="syoteparametri.arvo"/>
</script>
<script type="text/ng-template" id="kokonaisluku-template">
    <input ng-disabled="alikaavaValues.isAlikaava" type="text" size="15" ng-model="syoteparametri.arvo"/>
</script>
<script type="text/ng-template" id="totuusarvo-template">
    <input ng-disabled="alikaavaValues.isAlikaava" type="radio" size="15" ng-model="syoteparametri.arvo"
           value="true"/> Tosi
    <input ng-disabled="alikaavaValues.isAlikaava" type="radio" size="15" ng-model="syoteparametri.arvo"
           value="false"/> Epätosi
</script>
<script type="text/ng-template" id="merkkijono-template">
    <input ng-disabled="alikaavaValues.isAlikaava" type="text" size="15" ng-model="syoteparametri.arvo"/>
</script>
<script type="text/ng-template" id="arvojoukko-template">
    <select ng-disabled="alikaavaValues.isAlikaava" ng-model="syoteparametri.arvo"
            ng-options="arvo.avain as arvo.arvo for arvo in funktiokuvausSyoteparametri.arvojoukko | orderBy:'arvo'">
        <option value=""></option>
    </select>
</script>
<!-- Valintaperuste default template -->
<script type="text/ng-template" id="valintaperuste-default-template">
    <div class="form-item-content">
        <form class="form-horizontal valintaperuste-form" style="overflow-x: scroll" role="form">
            <h3 ng-if="valintaperusteviite.kuvaus">{{valintaperusteviite.kuvaus}}</h3>

            <h3 ng-if="!valintaperusteviite.kuvaus">{{valintaperusteviite.nimi}}</h3>

            <div class="form-group">
                <label class="col-sm-3 control-label">{{ t('laskentakaavaviiteasetuksetmodal.tyyppi') || 'Tyyppi' }}</label>
                <div class="col-sm-9">
                    <select ng-disabled="alikaavaValues.isAlikaava" ng-model="valintaperuste.lahde" ng-if="!isYoFunktiokutsu(funktioSelection)"
                            ng-options="item.key as item.text for item in valintaperusteviitetyypit">
                    </select>
                    <p class="form-control-static" ng-init="valintaperuste.lahde = 'HAETTAVA_ARVO'" ng-if="isYoFunktiokutsu(funktioSelection)" >{{ t('laskentakaavat.funktioasetukset.haettava_arvo') || 'Arvo hakemukselta' }}</p>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">{{ t('laskentakaavaviiteasetuksetmodal.pakollinen') || 'Pakollinen
                    tieto' }}</label>

                <div class="col-sm-9">
                    <input ng-disabled="alikaavaValues.isAlikaava" type="checkbox" id="requiredparam"
                           ng-model="valintaperuste.onPakollinen"/>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">{{ t('laskentakaavaviiteasetuksetmodal.kuvaus') || 'Kuvaus'
                    }}</label>

                <div class="col-sm-9">
                    <textarea ng-disabled="alikaavaValues.isAlikaava" style="width: 330px"
                              ng-model="valintaperuste.kuvaus"></textarea>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">{{ t('laskentakaavaviiteasetuksetmodal.tunniste') || 'Tunniste'
                    }}</label>
                <!--<div class="col-sm-9" ng-if="valintaperusteviite.tyyppi != 'ARVOJOUKKO'">-->
                <!--<div ng-if="valintaperuste.lahde === 'HAETTAVA_ARVO' && data.length > 0">-->
                <!--<select ng-model="valintaperuste.tunniste" ng-options="data._id as data.answers for data in bigdata"></select>-->
                <!--</div>-->
                <div class="col-sm-9">
                    <div>
                        <div ng-if="valintaperuste.lahde === 'HAETTAVA_ARVO' && bigdata.length > 0">
                        <p class="form-control-static">Hakulomakkeen tunniste</p>


                            <select ng-model="valintaperuste.tunniste"
                                    ng-options="data.key as data.value for data in bigdata"
                                    ng-disabled="alikaavaValues.isAlikaava">
                                <option value=""></option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <div ng-if="valintaperuste.lahde === 'HAETTAVA_ARVO' && lisakysymysAvaimet.length > 0">
s
                        <p class="form-control-static">Lisäkysymyksen tunniste</p>
                            <select ng-model="valintaperuste.tunniste"
                                    ng-options="data.key as data.value for data in lisakysymysAvaimet"
                                    ng-disabled="alikaavaValues.isAlikaava">
                                <option value=""></option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <p class="form-control-static">Vapaamuotoinen tunniste</p>
                        <input ng-disabled="alikaavaValues.isAlikaava" type="text" ng-model="valintaperuste.tunniste"
                               required="required"/>
                    </div>

                <span ng-if="valintaperuste.lahde === 'SYOTETTAVA_ARVO'" ng-click="generateSyoteId(valintaperuste)"
                      class="btn btn-sm btn-default">{{ t('laskentakaavaviiteasetuksetmodal.generoi') || 'Generoi tunniste' }}</span>
                </div>
            </div>
    </div>

    <div class="col-sm-9" ng-if="valintaperusteviite.tyyppi == 'ARVOJOUKKO'">
        <select ng-disabled="alikaavaValues.isAlikaava" ng-model="valintaperuste.tunniste"
                ng-options="arvo.avain as arvo.arvo for arvo in valintaperusteviite.arvojoukko | orderBy:'arvo'"></select>
    </div>

    </div>
    <div class="form-group" ng-if="valintaperuste.lahde === 'SYOTETTAVA_ARVO'">
        <label class="col-sm-3 control-label">{{ t('laskentakaavaviiteasetuksetmodal.vaatiiOsallistumisen') || 'Vaatii
            osallistumisen' }}</label>

        <div class="col-sm-9">
            <input ng-disabled="alikaavaValues.isAlikaava" type="checkbox"
                   ng-model="valintaperuste.vaatiiOsallistumisen"
                   required="required"/>

        </div>
    </div>

    <div id="valintaperusteviite-kuvaukset">
        <h3>{{ t('laskentakaavaviiteasetuksetmodal.hylkays') || 'Hylkäysperustekuvaukset' }}</h3>

        <div class="valintaperuste-form" ng-if="valintaperuste.kuvaukset.tekstit.length > 0">
            <table class="table">
                <thead>
                <tr>
                    <td>{{ t('laskentakaavaviiteasetuksetmodal.kieli') || 'Kieli' }}</td>
                    <td>{{ t('laskentakaavaviiteasetuksetmodal.kuvaus') || 'Kuvaus' }}</td>
                    <td>{{ t('valintaperusteet.poista') || 'Poista'}}</td>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="kuvaus in valintaperuste.kuvaukset.tekstit">
                    <td><select ng-disabled="alikaavaValues.isAlikaava" ng-model="kuvaus.kieli"
                                ng-options="item.key as item.text for item in arvokonvertterikuvauskielet"></select>
                    </td>
                    <td><input ng-disabled="alikaavaValues.isAlikaava" type="text" size="15"
                               ng-model="kuvaus.teksti"/></td>
                    <td>
                        <button class="btn btn-sm btn-default" ng-disabled="alikaavaValues.isAlikaava"
                                ng-click="removeValintaperusteviiteKuvaus($index, valintaperuste)"><i
                                class="fa fa-trash-o"></i></button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <button ng-disabled="alikaavaValues.isAlikaava" class="btn btn-sm btn-default"
                ng-click="addValintaperusteviitekuvaus(valintaperuste)"><i
                class="fa fa-plus"></i> {{ t('laskentakaavaviiteasetuksetmodal.kuvaus') || 'Kuvaus' }}
        </button>
    </div>

    </form>
    </div>
</script>


<!-- ARVOVÄLIKONVERTTERI template -->
<script type="text/ng-template" id="arvovalikonvertteri-template">
    <div class="form-item-content">

        <div class="settingsbox">
            <form ng-repeat="parametri in funktioSelection.lapsi.arvovalikonvertteriparametrit"
                  class="form-horizontal arvovalikonvertteri-form " role="form">
                <div>
                    <button ng-disabled="alikaavaValues.isAlikaava" class="btn btn-sm btn-default"
                            ng-click="removeKonvertteriParametri($index, 'ARVOVALIKONVERTTERI')"><i
                            class="fa fa-trash-o"></i> {{ t('laskentakaavaviiteasetuksetmodal.poistaparametri') || 'Poista parametri' }}
                    </button>
                </div>
                <div>
                    <span>
                        <input ng-disabled="alikaavaValues.isAlikaava" type="text" size="10"
                               ng-model="parametri.minValue" placeholder="Min"/>
                   </span>

                    <span ng-show="!$last" class="white-space-nowrap">&le; x &lt;</span>
                    <span ng-show="$last" class="white-space-nowrap">&le; x &le;</span>

                   <span>
                        <input ng-disabled="alikaavaValues.isAlikaava" type="text" size="10"
                               ng-model="parametri.maxValue" placeholder="Max"/>
                   </span>
                </div>
                <div class="checkbox">
                    <label>
                        <input ng-disabled="alikaavaValues.isAlikaava" type="checkbox"
                               ng-model="parametri.palautaHaettuArvo" ng-true-value="true"
                               ng-false-value="false"/> {{ t('laskentakaavaviiteasetuksetmodal.palauta') || 'Palauta haettu arvo' }}
                    </label>
                </div>
                <div class="form-group">
                    <label class="col-sm-5 control-label">{{ t('laskentakaavaviiteasetuksetmodal.pisteet') || 'Pisteet' }}</label>
                    <input type="text" size="10" ng-model="parametri.paluuarvo" placeholder="{{ t('laskentakaavaviiteasetuksetmodal.pisteet') || 'Pisteet' }}"
                           ng-disabled="parametri.palautaHaettuArvo == 'true' || alikaavaValues.isAlikaava"/>
                </div>
                <div class="form-group">
                    <div class="col-sm-offset-5 col-sm-7">
                        <div class="checkbox">
                            <label>
                                <input ng-disabled="alikaavaValues.isAlikaava" type="checkbox"
                                       ng-model="parametri.hylkaysperuste" ng-true-value="true"
                                       ng-false-value="false"/> {{ t('laskentakaavaviiteasetuksetmodal.hylkaysperuste') || 'Hylkäysperuste' }}
                            </label>
                        </div>
                    </div>
                </div>
                <div id="arvovalikonvertteri-kuvaukset" ng-if="parametri.hylkaysperuste">
                    <div><b>{{ t('laskentakaavaviiteasetuksetmodal.hylkays') || 'Hylkäysperustekuvaukset' }}</b></div>
                    <table class="table" ng-if="parametri.kuvaukset.tekstit.length > 0">
                        <thead>
                        <tr>
                            <td>{{ t('laskentakaavaviiteasetuksetmodal.kieli') || 'Kieli' }}</td>
                            <td>{{ t('laskentakaavaviiteasetuksetmodal.kuvaus') || 'Kuvaus' }}</td>
                            <td></td>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="kuvaus in parametri.kuvaukset.tekstit">
                            <td><select ng-disabled="alikaavaValues.isAlikaava" ng-model="kuvaus.kieli"
                                        ng-options="item.key as item.text for item in arvokonvertterikuvauskielet"></select>
                            </td>
                            <td><input ng-disabled="alikaavaValues.isAlikaava" type="text" size="15"
                                       ng-model="kuvaus.teksti"/></td>
                            <td>
                                <button class="btn btn-sm btn-default" ng-disabled="alikaavaValues.isAlikaava"
                                        ng-click="removeKonvertteriParametriKuvaus($index, parametri)"><i
                                        class="fa fa-trash-o"></i></button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <button ng-disabled="alikaavaValues.isAlikaava" class="btn btn-sm btn-default"
                            ng-click="addArvokonvertterikuvaus(parametri)"><i
                            class="fa fa-plus"></i> {{ t('laskentakaavaviiteasetuksetmodal.kuvaus') || 'Kuvaus' }}
                    </button>
                </div>
            </form>


        </div>
    </div>
</script>


<!-- ARVOKONVERTTERI template -->
<script type="text/ng-template" id="arvokonvertteri-template">


    <div class="settingsbox">
        <form ng-repeat="parametri in funktioSelection.lapsi.arvokonvertteriparametrit"
              class="form-horizontal arvokonvertteri-form" role="form">
            <div class="pull-left">
                <button ng-disabled="alikaavaValues.isAlikaava"
                        ng-click="removeKonvertteriParametri($index, 'ARVOKONVERTTERI')"><i
                        class="fa fa-trash-o"></i></button>
            </div>
            <div class="clearfix"/>
            <div class="form-group">
                <label class="col-sm-5 control-label">{{ t('laskentakaavaviiteasetuksetmodal.arvo') || 'Arvo' }}</label>

                <div class="col-sm-7"
                     ng-if="funktiokuvausForSelection.konvertteri.konvertteriTyypit[0].arvotyyppi != 'ARVOJOUKKO'">
                    <input ng-disabled="alikaavaValues.isAlikaava" type="text" size="9" ng-model="parametri.arvo"
                           placeholder="{{ t('laskentakaavaviiteasetuksetmodal.arvo') || 'Arvo' }}"/>
                </div>

                <div class="col-sm-7"
                     ng-if="funktiokuvausForSelection.konvertteri.konvertteriTyypit[0].arvotyyppi == 'ARVOJOUKKO'">
                    <select ng-disabled="alikaavaValues.isAlikaava" ng-model="parametri.arvo"
                            ng-options="arvo.avain as arvo.arvo for arvo in funktiokuvausForSelection.konvertteri.konvertteriTyypit[0].arvojoukko | orderBy:'arvo'"></select>
                </div>

            </div>
            <div class="form-group">
                <label class="col-sm-5 control-label">{{ t('laskentakaavaviiteasetuksetmodal.pisteet') || 'Pisteet'
                    }}</label>

                <div class="col-sm-7">
                    <input ng-disabled="alikaavaValues.isAlikaava" type="text" size="9" ng-model="parametri.paluuarvo"
                           placeholder="{{ t('laskentakaavaviiteasetuksetmodal.pisteet') || 'Pisteet' }}"/>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-5 col-sm-7">
                    <div class="checkbox">
                        <label>
                            <input ng-disabled="alikaavaValues.isAlikaava" type="checkbox"
                                   ng-model="parametri.hylkaysperuste" ng-true-value="true"
                                   ng-false-value="false"/> {{ t('laskentakaavaviiteasetuksetmodal.hylkaysperuste') ||
                            'Hylkäysperuste' }}
                        </label>
                    </div>
                </div>
            </div>
            <div id="arvokonvertteri-kuvaukset" ng-if="parametri.hylkaysperuste">
                <div><b>{{ t('laskentakaavaviiteasetuksetmodal.hylkays') || 'Hylkäysperustekuvaukset' }}</b></div>
                <table class="table" ng-if="parametri.kuvaukset.tekstit.length > 0">
                    <thead>
                    <tr>
                        <td>{{ t('laskentakaavaviiteasetuksetmodal.kieli') || 'Kieli' }}</td>
                        <td>{{ t('laskentakaavaviiteasetuksetmodal.kuvaus') || 'Kuvaus' }}</td>
                        <td></td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="kuvaus in parametri.kuvaukset.tekstit">
                        <td><select ng-disabled="alikaavaValues.isAlikaava" ng-model="kuvaus.kieli"
                                    ng-options="item.key as item.text for item in arvokonvertterikuvauskielet"></select>
                        </td>
                        <td><input type="text" size="15" ng-model="kuvaus.teksti"/></td>
                        <td>
                            <button ng-disabled="alikaavaValues.isAlikaava"
                                    ng-click="removeKonvertteriParametriKuvaus($index, parametri)"><i
                                    class="fa fa-trash-o"></i></button>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <button ng-disabled="alikaavaValues.isAlikaava" class="button small"
                        ng-click="addArvokonvertterikuvaus(parametri)"><i class="fa fa-plus"></i> {{
                    t('laskentakaavaviiteasetuksetmodal.kuvaus') || 'Kuvaus' }}
                </button>
            </div>
        </form>
    </div>

</script>


<div class="modal-header">
    <!-- Funktiokutsun asetukset -->
    <h3 ng-show="!toggle">{{ t('laskentakaavaviiteasetuksetmodal.funktioasetukset') || 'Funktioasetukset' }}</h3>

    <!-- tallenna funktiokutsu laskentakaavana -->
    <h3 ng-show="toggle">{{ t('laskentakaavaviiteasetuksetmodal.tallentaminen') || 'Funktiokutsun tallentaminen laskentakaavana' }}</h3>

</div>
<div class="modal-body">

    <!-- Funktiokutsun asetukset -->
    <div collapse="toggle">
        <div ng-if="alikaavaValues.isAlikaava" class="alert alert-info margin-top-2">{{ t('laskentakaavaviiteasetuksetmodal.eivoimuokata') || 'Alikaavan funktiokutsuja ei voi muokata.' }}
        </div>

        <h2 ng-if="funktioSelection">Funktiokutsun tyyppi: {{getFunktiokutsuName(funktioSelection)}}</h2>

        <div class="settingsform">

            <!-- Valintaperusteviitteet -->
            <div class="form-item">
                <div ng-if="funktiokuvausForSelection.valintaperusteviitteet">
                    <label class="form-item-label" style="width:50px;">{{ t('laskentakaavaviiteasetuksetmodal.valintaperusteviitteet') || 'Valintaperusteviitteet' }}</label>

                    <div ng-if="funktioSelection.lapsi.valintaperusteviitteet"
                         ng-repeat="valintaperusteviite in funktiokuvausForSelection.valintaperusteviitteet"
                         class="valintaperusteviite-form"
                         ng-init="valintaperuste = getValintaperuste(funktioSelection.lapsi.valintaperusteviitteet, $index)"
                         ng-include="'valintaperuste-default-template'">
                    </div>
                </div>
            </div>

            <!-- Konvertterit -->
            <div class="form-item">

                <div ng-if="funktiokuvausForSelection.konvertteri">
                    <label class="form-item-label" style="width:50px;">{{ t('laskentakaavaviiteasetuksetmodal.arvomuunnin') || 'Arvomuunnin' }}</label>

                    <div class="form-item-content">
                        <div class="field-select-containerbox">

                            <select ng-disabled="alikaavaValues.isAlikaava"
                                    ng-change="changeKonvertteriparametriTypeSelection(funktioasetukset.konvertteriType)"
                                    ng-model="funktioasetukset.konvertteriType"
                                    ng-options="konvertterityyppi.tyyppi as konvertterityyppi.tyyppi for konvertterityyppi in funktiokuvausForSelection.konvertteri.konvertteriTyypit">
                            </select>

                        </div>
                    </div>

                    <div class="form-item">
                        <label ng-if="funktioSelection.lapsi.arvokonvertteriparametrit.length > 0 || funktioSelection.lapsi.arvovalikonvertteriparametrit.length > 0"
                               class="form-item-label" style="width:100px;">{{ t('laskentakaavaviiteasetuksetmodal.konversiomaarittelyt') || 'Konversiomäärittelyt' }}</label>

                        <div class="form-item-content"
                             ng-if="funktioSelection.lapsi.arvokonvertteriparametrit.length > 0"
                             ng-include="'arvokonvertteri-template'"></div>
                        <div class="form-item-content"
                             ng-if="funktioSelection.lapsi.arvovalikonvertteriparametrit.length > 0"
                             ng-include="'arvovalikonvertteri-template'"></div>
                        <div class="clear"></div>
                    </div>

                    <button ng-disabled="alikaavaValues.isAlikaava" class="btn btn-sm btn-default"
                            ng-click="addFunktiokonvertteriparametri()"><i
                            class="fa fa-plus"></i> {{ t('laskentakaavaviiteasetuksetmodal.parametri') || 'Parametri' }}
                    </button>

                </div>

                <div class="clear"></div>
            </div>

            <!-- SYÖTEPARAMETRIT -->
            <div class="form-item">
                <label class="form-item-label" style="width:150px;">{{ t('laskentakaavaviiteasetuksetmodal.arvonmaarittelyt') || 'Arvon määrittelyt' }}</label>

                <div class="form-item-content">

                    <div class="settingsbox">
                        <table class="settingstable table table-striped">
                            <thead>
                            <tr>
                                <td>{{ t('laskentakaavaviiteasetuksetmodal.maarite') || 'Määrite' }}</td>
                                <td>{{ t('laskentakaavaviiteasetuksetmodal.arvo') || 'Arvo' }}</td>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="funktiokuvausSyoteparametri in funktiokuvausForSelection.syoteparametrit">
                                <td ng-if="funktiokuvausSyoteparametri.kuvaus.length <= 0">{{ t('laskentakaavaviiteasetuksetmodal.avain') || 'Avain' }}:
                                    {{funktiokuvausSyoteparametri.avain}}
                                </td>
                                <td ng-if="funktiokuvausSyoteparametri.kuvaus.length > 0">
                                    {{funktiokuvausSyoteparametri.kuvaus}}
                                </td>
                                <td ng-init="syoteparametri = getSyoteparametri(funktioSelection.lapsi.syoteparametrit, funktiokuvausSyoteparametri)"
                                    ng-include="getSyoteparametriTemplate(funktiokuvausSyoteparametri.tyyppi)"></td>
                            </tr>
                            <tr>
                                <td>{{ t('laskentakaavaviiteasetuksetmodal.tallennatulos') || 'Tallenna tulos' }}</td>
                                <td><input ng-disabled="alikaavaValues.isAlikaava" type="checkbox" size="25"
                                           ng-model="funktioSelection.lapsi.tallennaTulos"/></td>
                            </tr>
                            <tr ng-show="funktioSelection.lapsi.tallennaTulos">
                                <td>{{ t('laskentakaavaviiteasetuksetmodal.tulostunniste') || 'Tulostunniste' }}</td>
                                <td><input ng-disabled="alikaavaValues.isAlikaava" type="text" size="25"
                                           placeholder="{{ t('laskentakaavaviiteasetuksetmodal.tulostunnistepakollinen') || 'Tulostunniste on pakollinen' }}"
                                           ng-model="funktioSelection.lapsi.tulosTunniste"/><i
                                        class="margin-left-1 fa fa-exclamation red"></i></td>
                            </tr>
                            <tr ng-show="funktioSelection.lapsi.tallennaTulos">
                                <td>{{ t('laskentakaavaviiteasetuksetmodal.tulostekstifi') || 'Tulosteksti FI' }}</td>
                                <td><input ng-disabled="alikaavaValues.isAlikaava" type="text" size="25"
                                           ng-model="funktioSelection.lapsi.tulosTekstiFi"/></td>
                            </tr>
                            <tr ng-show="funktioSelection.lapsi.tallennaTulos">
                                <td>{{ t('laskentakaavaviiteasetuksetmodal.tulostekstisv') || 'Tulosteksti SV' }}</td>
                                <td><input ng-disabled="alikaavaValues.isAlikaava" type="text" size="25"
                                           ng-model="funktioSelection.lapsi.tulosTekstiSv"/></td>
                            </tr>
                            <tr ng-show="funktioSelection.lapsi.tallennaTulos">
                                <td>{{ t('laskentakaavaviiteasetuksetmodal.tulostekstien') || 'Tulosteksti EN' }}</td>
                                <td><input ng-disabled="alikaavaValues.isAlikaava" type="text" size="25"
                                           ng-model="funktioSelection.lapsi.tulosTekstiEn"/></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
    </div>


    <!-- tallenna funktiokutsu laskentakaavana -->
    <div collapse="!toggle">
        <form name="kaavaForm" class="form-horizontal margin-top-2">

            <div class="form-group">
                <label class="col-sm-4 control-label">{{ t('laskentakaavaviiteasetuksetmodal.laskentakaavaksi') || 'Laskentakaavaksi tallennettava funktiokutsu' }}</label>
                <span class="col-sm-8 control-content" ng-if="funktioSelection">{{getFunktiokutsuName(funktioSelection)}}</span>
            </div>


            <div class="form-group">
                <label class="col-sm-4 control-label">{{ t('laskentakaavaviiteasetuksetmodal.laskentakaavannimi') || 'Laskentakaavan nimi' }}</label>
                <div class="col-sm-8">
                    <input type="text" ng-model="newKaavaNimi" required/>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-4 control-label">{{ t('laskentakaavaviiteasetuksetmodal.laskentakaavankuvaus') || 'Laskentakaavan kuvaus' }}</label>

                <div class="col-sm-8">
                    <textarea ng-model="newKaavaKuvaus"></textarea>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-4 control-label">{{ t('laskentakaavaviiteasetuksetmodal.laskentakaavantyyppi') || 'Laskentakaavan tyyppi' }}</label>
                <div class="col-sm-8">
                    <input ng-disabled="true" type="radio" name="tyyppi" value="TOTUUSARVOFUNKTIO" ng-model="funktioSelection.lapsi.tyyppi"/>
                    {{ t('laskentakaavaviiteasetuksetmodal.totuusarvofunktio') || 'Totuusarvofunktio' }}
                    <br/>
                    <input ng-disabled="true" type="radio" name="tyyppi" value="LUKUARVOFUNKTIO" ng-model="funktioSelection.lapsi.tyyppi"/> {{ t('laskentakaavaviiteasetuksetmodal.lukuarvofunktio') || 'Lukuarvofunktio' }}
                </div>
                <div class="clear"></div>
            </div>

        </form>
    </div>
</div>


<div class="modal-footer">
    <!-- Funktiokutsun asetukset -->
    <div ng-show="!toggle">
        <button class="btn btn-default btn-sm"
                ng-disabled="alikaavaValues.isAlikaava || funktioasetukset.parentFunktiokutsu === model.laskentakaavapuu.funktiokutsu"
                ng-click="toggle = !toggle">{{ t('laskentakaavaviiteasetuksetmodal.kaavanosantallennus') || 'Kaavan osan tallennus' }}
        </button>
        <button ng-disabled="alikaavaValues.isAlikaava" class="btn btn-sm btn-default"
                ng-click="removeFunktiokutsu(); sulje()" popover-popup-delay="500" popover-placement="top" popover-trigger="mouseenter" popover="{{ t('laskentakaavaviiteasetuksetmodal.muutokseteivat') || 'Muutokset eivät tallennu ennen kuin tallennat kaavan laskentakaavanäkymästä' }}"><i class="fa fa-trash-o"></i> {{ t('laskentakaavaviiteasetuksetmodal.poistafunktiokutsu') || 'Poista funktiokutsu' }}
        </button>
        <button class="btn btn-default btn-sm" ng-click="sulje()"
            role="button" popover-popup-delay="500" popover-placement="top" popover-trigger="mouseenter" popover="{{ t('laskentakaavaviiteasetuksetmodal.muutokseteivat') || 'Muutokset eivät tallennu ennen kuin tallennat kaavan laskentakaavanäkymästä' }}">{{ t('laskentakaavaviiteasetuksetmodal.sulje') || 'Sulje' }}
        </button>
    </div>

    <!-- tallenna funktiokutsu laskentakaavana -->
    <div ng-show="toggle">
        <button class="btn btn-default btn-sm" ng-click="toggle = !toggle" popover-popup-delay="500" popover-placement="top" popover-trigger="mouseenter" popover="{{ t('laskentakaavaviiteasetuksetmodal.muutokseteivat') || 'Muutokset eivät tallennu ennen kuin tallennat kaavan laskentakaavanäkymästä' }}"><i class="fa fa-arrow-left"></i> {{ t('laskentakaavaviiteasetuksetmodal.palaafunktioasetuksiin') || 'Palaa funktioasetuksiin' }}</button>
        <button class="btn btn-primary btn-sm" ng-disabled="!newKaavaNimi" ng-click="saveAsNewLaskentakaava(funktioasetukset.parentFunktiokutsu, funktioSelection, newKaavaNimi, newKaavaKuvaus, sulje)"><i class="fa fa-floppy-o"></i> {{ t('laskentakaavaviiteasetuksetmodal.tallenna') || 'Tallenna uutena laskentakaavana' }}</button>
        <button class="btn btn-default btn-sm" ng-click="sulje()" popover-popup-delay="500" popover-placement="top" popover-trigger="mouseenter" popover="{{ t('laskentakaavaviiteasetuksetmodal.muutokseteivat') || 'Muutokset eivät tallennu ennen kuin tallennat kaavan laskentakaavanäkymästä' }}">{{ t('laskentakaavaviiteasetuksetmodal.sulje') || 'Sulje' }}</button>
    </div>
</div>




